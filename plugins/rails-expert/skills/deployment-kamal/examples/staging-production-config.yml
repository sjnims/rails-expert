# Staging + Production Environments
#
# Use environment-specific deploy files for different deployment targets.
# Deploy to staging: kamal deploy -d staging
# Deploy to production: kamal deploy

# =============================================================================
# config/deploy.yml (production - base configuration)
# =============================================================================
service: myapp
image: company/myapp

servers:
  web:
    hosts:
      - prod-1.myapp.com
      - prod-2.myapp.com

proxy:
  ssl: true
  host: myapp.com

env:
  clear:
    RAILS_ENV: production
  # ⚠️ SECURITY: Set these in .kamal/secrets - NEVER commit credentials to git
  secret:
    - RAILS_MASTER_KEY
    - DATABASE_URL

# =============================================================================
# config/deploy.staging.yml (staging overrides)
# =============================================================================
# This file only contains values that differ from production.
# All other settings are inherited from deploy.yml.

---
servers:
  web:
    hosts:
      - staging.myapp.com

proxy:
  ssl: true
  host: staging.myapp.com

env:
  clear:
    RAILS_ENV: staging
  # ⚠️ SECURITY: Use separate staging secrets in .kamal/secrets - NEVER share with production
  secret:
    - RAILS_MASTER_KEY_STAGING
    - DATABASE_URL_STAGING
